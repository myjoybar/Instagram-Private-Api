package com.joy.instagramapi.webview;

import java.util.HashMap;
import java.util.Map;

/**
 * Created by Joy on 2020-04-07
 */
public class JsContent {

  public static final String PREFIX = "javascript:"; //要加密
  public static final String CONTENT_LOGIN = PREFIX
      + "function waitForSelector(e){return new Promise(t=>{const l=setInterval(()=>{document.querySelectorAll(e).length>0&&(clearInterval(l),t(document.querySelectorAll(e)))},500)})}function setValue(e,t){let l=e.value;e.value=t;let n=new Event(\"input\",{bubbles:!0});n.simulated=!0;let a=e._valueTracker;a&&a.setValue(l),e.dispatchEvent(n)}function sleep(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}!async function(){\"use strict\";function e(){waitForSelector('button[type=\"submit\"]').then(async e=>{if(e.length>1)return;setValue(document.querySelectorAll('input[name=\"username\"]')[0],\"hahali5\"),await sleep(1700),setValue(document.querySelectorAll('input[name=\"password\"]')[0],\"alskdj\"),await sleep(800),e[0].removeAttribute(\"disabled\"),e[0].click()})}console.log(\"ins login 789\"),waitForSelector('span>button[type=\"button\"]').then(async t=>{t.length>1||(await sleep(1100),t[0].click(),await sleep(1600),e())}),await sleep(100),e()}();";

  public static final String CONTENT_REGISTER = PREFIX+
      "!async function(){try{r(\"instagram regist\");let s=\"\",u=\"{{REPLACE_COUNTRY}}\",p=\"{{REPLACE_C_NAME}}\",w=\"{{REPLACE_PHONE}}\",m=\"{{REPLACE_FULLNAME}}\",d=\"{{REPLACE_PASSWORD}}\",y=\"{{REPLACE_CODE}}\",h=\"{{REPLACE_BIRTHDAY_YEAR}}\",g=\"{{REPLACE_BIRTHDAY_MONTH}}\",f=\"{{REPLACE_BIRTHDAY_DAY}}\",A={},b={};window.androidCallJS=(e=>{r(\"androidCallJs: \",e),e&&((e=JSON.parse(e)).phoneNumber&&(w=e.phoneNumber),e.fullName&&(m=e.fullName),e.pwd&&(d=e.pwd),e.countryCode&&(u=e.countryCode),e.country&&(p=e.country),e.smsCode&&(y=e.smsCode),e.birth&&(e.birth.year&&(h=e.birth.year),e.birth.month&&(g=e.birth.month),e.birth.day&&(f=e.birth.day)),A=e,e.smsCode&&b.PhoneCodePage&&b.PhoneCodePage())}),setTimeout(()=>{s||c({msg:\"未检测到任何页面，可能是ui变更\"})},3e4);let _=\"\";if(i()&&a(\"www.instagram.com/accounts/username_suggestions/\",e=>{r(e),\"ok\"===e.status&&(r(\"check_phone_number ok\"),r(\"suggestionsUsername: \"+(_=e.suggestions[0])))}),l({type:\"2009\"}),await t(5e3),window._sharedData.config.viewer)return void r(\"has logined\");function e(e,t){return new Promise(n=>{const o=setInterval(()=>{t?Array.prototype.slice.call(document.querySelectorAll(e),0).filter(e=>e.innerText.match(t)).length>0&&(clearInterval(o),n(document.querySelectorAll(e))):document.querySelectorAll(e).length>0&&(clearInterval(o),n(document.querySelectorAll(e)))},1e3)})}function t(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}function n(e,t){let n=e.value;e.value=t;let o=new Event(\"input\",{bubbles:!0});o.simulated=!0;let a=e._valueTracker;a&&a.setValue(n),e.dispatchEvent(o)}function o(e,t){e.value=t;let n=new Event(\"change\",{bubbles:!0});e.dispatchEvent(n)}function a(e,t){var n;n=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(){this.addEventListener(\"readystatechange\",function(){if(4===this.readyState&&this.responseURL.match(e)){const e=JSON.parse(this.responseText);t(e)}},!1),n.apply(this,arguments)}}function i(){return\"https://www.instagram.com/accounts/signup/username\"===window.location.href}function r(e,t){let n=\"\";n+=\"string\"==typeof e?e:JSON.stringify(e),t&&(n+=\" \",n+=\"string\"==typeof t?t:JSON.stringify(t)),l({type:\"2005\",logInfo:n})}b={async ChangeUserIndex(){Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/切换帐户|Switch accounts/i))[0].click()},async LoginAPage(){Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/切换帐户|Switch accounts/i))[0].click(),await t(1e3),b.LoginBPage()},async LoginBPage(){document.querySelectorAll('a[href=\"/accounts/signup/phone\"]')[0].click()},async SwitchIndex(){const e=Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0);await t(1e3),e.filter(e=>e.innerText.match(/使用邮箱或手机号注册|Sign up with email or phone number/i))[0].click()},async RegistPage(){await t(1200),await e('input[name=\"phone\"]'),await t(1200);const o=document.querySelectorAll('input[name=\"phone\"]')[0];if(p.indexOf(\"{\")>-1)r(\"need country\",p);else{if(o.previousSibling){if(!document.querySelectorAll('button[type=\"button\"] > div')[0].innerHTML.endsWith(u))try{document.querySelectorAll('button[type=\"button\"]')[0].click(),await t(1200);const e=document.querySelectorAll('input[name=\"filter\"]')[0];await t(2200),n(e,p),await t(1200),Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]>div>div'),0).filter(e=>e.innerText.match(/^\\+/))[0].parentNode.parentNode.click()}catch(e){return r(\"未选择到country\"),void c({msg:\"未选择到country\"})}}else w=u+w;w.indexOf(\"{\")>-1?r(\"need phone\"):(await t(1800),n(o,w),a(\"www.instagram.com/accounts/check_phone_number/\",e=>{r(e),\"ok\"===e.status?r(\"check_phone_number ok\"):(r(\"check_phone_number not ok\",e),c(e))}),a(\"www.instagram.com/accounts/send_signup_sms_code_ajax/\",e=>{r(e),\"ok\"===e.status&&e.sms_sent?r(\"send_signup_sms_code_ajax ok\"):(r(\"send_signup_sms_code_ajax not ok\",e),c(e))}),await t(1300),Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/下一步|Next/i))[0].click())}},async PhoneCodePage(){await e('input[name=\"twofac\"]');const o=document.querySelectorAll('input[name=\"twofac\"]')[0];\"{{REPLACE_CODE}}\"!==y?(await t(1700),n(o,y),a(\"www.instagram.com/accounts/validate_signup_sms_code_ajax/\",e=>{r(e),\"ok\"===e.status&&e.verified?r(\"validate_signup_sms_code_ajax ok\"):(r(\"validate_signup_sms_code_ajax not ok\",e),c(e))}),await t(1300),Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/下一步|Next/i))[0].click()):r(\"PhoneCodePage, need server code\")},async FullnamePage(){if(m.indexOf(\"{\")>-1||d.indexOf(\"{\")>-1)return void r(\"need REPLACE_FULLNAME\");await e('input[name=\"fullName\"]');const o=document.querySelectorAll('input[name=\"fullName\"]')[0];await t(1700),n(o,m);const a=document.querySelectorAll('input[name=\"password\"]')[0];await t(1800),n(a,d),await t(2200),Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/下一步|Next/i))[0].click()},async BirthdayPage(){if(h.indexOf(\"{\")>-1||g.indexOf(\"{\")>-1||f.indexOf(\"{\")>-1)return void r(\"need replace REPLACE_BIRTHDAY_YEAR\");await e(\"select\"),await t(2400),o(document.querySelectorAll(\"select\")[2],h),await t(1400),o(document.querySelectorAll(\"select\")[0],g.replace(/^0/,\"\")),await t(1600),o(document.querySelectorAll(\"select\")[1],f.replace(/^0/,\"\")),a(\"www.instagram.com/web/consent/check_age_eligibility/\",e=>{r(e),\"ok\"===e.status&&e.eligible_to_register&&!e.parental_consent_required?r(\"check_age_eligibility ok\"):(r(\"check_age_eligibility not ok\",e),c(e))}),await t(1300),Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/下一步|Next/i))[0].click()},async UseruamePage(){await e('button[type=\"button\"]',/下一步|Next/i),a(\"www.instagram.com/accounts/web_create_ajax/\",e=>{r(e),\"ok\"===e.status&&e.account_created?(r(\"web_create_ajax status ok\"),l(Object.assign({},A,{type:\"2001\",userName:_||function(){const e=Array.prototype.slice.call(document.querySelectorAll(\"h1\"),0).filter(e=>0===e.children.length)[0];if(e)return e.innerText.indexOf(\"欢迎使用\")>-1?e.innerText.split(\"，\")[0].replace(/^\\s+|\\s+$/gm,\"\"):e.innerText.split(\",\")[0].replace(/^\\s+|\\s+$/gm,\"\");return\"\"}()}))):(r(\"send_signup_sms_code_ajax status not ok\",e),c(e))}),await t(3300),Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/下一步|Next/i))[0].click()},async RelatePage(){await e('button[type=\"button\"]',/跳过|Skip/i),await t(3600),Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/跳过|Skip/i))[0].click(),await t(5e3),await e('div[role=\"dialog\"] button',/跳过|Skip/i),await t(3e3),Array.prototype.slice.call(document.querySelectorAll('div[role=\"dialog\"] button'),0).filter(e=>e.innerText.match(/跳过|Skip/i))[0].click()},async UploadAvatarPage(){await e(\"button\",/跳过|Skip/i),await t(3e3),Array.prototype.slice.call(document.querySelectorAll(\"button\"),0).filter(e=>e.innerText.match(/跳过|Skip/i))[0].click(),await t(5e3),await e('div[role=\"dialog\"] button',/跳过|Skip/i),await t(3e3),Array.prototype.slice.call(document.querySelectorAll('div[role=\"dialog\"] button'),0).filter(e=>e.innerText.match(/跳过|Skip/i))[0].click()},async RecommendPage(){await e('ul>li>div>div>div>div>button[type=\"button\"]',/关注|follow/i),a(/www.instagram.com\\/web\\/friendships\\/.*\\/follow\\//,e=>{r(e),\"ok\"===e.status&&\"following\"===e.result?r(\"follow status ok\"):(r(\"follow status not ok\",e),c(e))}),await t(2300),Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/^\\s*关注|follow\\s*$/i))[0].click(),await t(3e3),document.querySelectorAll(\"button>div.coreSpritePagingChevron\")[0].parentNode.click(),await t(5e3),Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/^\\s*关注|follow\\s*$/i))[1].click(),await t(3200),document.querySelectorAll(\"button>div.coreSpritePagingChevron\")[0].parentNode.click(),await t(4e3),Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0).filter(e=>e.innerText.match(/^\\s*关注|follow\\s*$/i))[1].click(),await t(3800);const n=Array.prototype.slice.call(document.querySelectorAll(\"button>div\"),0).filter(e=>e.innerText.match(/轻触刷新|Tap to Refresh/i));n.length>0&&n[0].click(),await t(3e3),setInterval(()=>{window.scrollBy(0,parseInt(201*Math.random()+200,10))},parseInt(9001*Math.random()+1500,10))}},new Promise(e=>{\"https://www.instagram.com/accounts/signup/phone\"!==window.location.href?\"https://www.instagram.com/accounts/signup/twofac\"!==window.location.href?\"https://www.instagram.com/accounts/signup/name\"!==window.location.href?\"https://www.instagram.com/accounts/signup/birthday\"!==window.location.href?i()?e(\"UseruamePage\"):\"https://www.instagram.com/accounts/registered/\"!==window.location.href?\"https://www.instagram.com/accounts/registered/1\"!==window.location.href?Promise.race([new Promise(e=>{const t=setInterval(()=>{s?clearInterval(t):function(){const e=Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0);return\"https://www.instagram.com/accounts/login/\"===window.location.href&&e.filter(e=>e.innerText.match(/切换帐户|Switch accounts/i)).length>0}()&&e(\"LoginAPage\")},600)}),new Promise(e=>{const t=setInterval(()=>{s?clearInterval(t):\"https://www.instagram.com/accounts/login/\"===window.location.href&&document.querySelectorAll('input[name=\"password\"]').length>0&&e(\"LoginBPage\")},600)}),new Promise(e=>{const t=setInterval(()=>{s?clearInterval(t):function(){const e=Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0);return\"https://www.instagram.com/\"===window.location.href&&e.filter(e=>e.innerText.match(/切换帐户|Switch accounts/i)).length>0}()&&e(\"ChangeUserIndex\")},600)}),new Promise(e=>{const t=setInterval(()=>{s?clearInterval(t):function(){const e=Array.prototype.slice.call(document.querySelectorAll('button[type=\"button\"]'),0);return\"https://www.instagram.com/\"===window.location.href&&e.filter(e=>e.innerText.match(/使用邮箱或手机号注册|Sign up with email or phone number/i)).length>0}()&&e(\"SwitchIndex\")},600)}),new Promise(e=>{const t=setInterval(()=>{s?clearInterval(t):document.querySelectorAll('ul>li>div>div>div>div>button[type=\"button\"]').length>2&&\"https://www.instagram.com/\"===window.location.href&&e(\"RecommendPage\")},600)})]).then(t=>{e(t)}):e(\"UploadAvatarPage\"):e(\"RelatePage\"):e(\"BirthdayPage\"):e(\"FullnamePage\"):e(\"PhoneCodePage\"):e(\"RegistPage\")}).then(e=>{r(\"currentPage:\",e),l({type:\"2006\",pageUrl:window.location.href}),s=e,\"PhoneCodePage\"===e?l({type:\"2003\"}):b[e]()})}catch(e){c({error:e.toString()})}function c(e){l({type:\"2004\",errorMsg:JSON.stringify(e)})}function l(e){window.prompt(\"js://funs?arg=\"+JSON.stringify(e))}}();";
  public static final String CONTENT_FOLLOW= PREFIX;
  public static final String CONTENT_Like= PREFIX;

  public static Map<String,String> JS_MAP = new HashMap<>();


  static {

  }


}
